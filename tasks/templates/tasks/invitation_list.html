{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="p-view-header">
    <div style="display:flex; align-items:center; gap:10px;">
        <span class="p-channel-name">通知 / 招待</span>
    </div>
</div>

<div class="p-view-body">
    <div style="max-width: 800px; margin: 0 auto;">
        
        <div style="margin-bottom: 20px; font-size: 13px; color: #616061; border-bottom: 1px solid #E2E2E2; padding-bottom: 10px;">
            あなたへのタスク招待一覧
        </div>

        {% for invitation in invitations %}
        <div style="display: flex; gap: 12px; padding: 16px; background: white; border: 1px solid #E2E2E2; border-radius: 8px; margin-bottom: 12px; transition: 0.1s;">
            <div class="c-avatar" style="width: 36px; height: 36px; font-size: 16px; background: #E01E5A;">
                {{ invitation.sender.username|slice:":1" }}
            </div>

            <div style="flex-grow: 1;">
                <div style="font-size: 15px; margin-bottom: 4px;">
                    <span style="font-weight: 900;">{{ invitation.sender.username }}</span> 
                    <span style="color: #616061;">があなたをタスクに招待しました</span>
                </div>
                
                <div style="background: #F8F8F8; padding: 10px; border-radius: 6px; border-left: 4px solid #3F0E40; margin-bottom: 12px;">
                    <div style="font-weight: 700; font-size: 14px; margin-bottom: 4px;">{{ invitation.task.title }}</div>
                    <div style="font-size: 13px; color: #1D1C1D;">{{ invitation.task.description|truncatechars:50 }}</div>
                    <div style="font-size: 12px; color: #616061; margin-top: 4px;">期限: {{ invitation.task.due_date|date:"Y/m/d H:i"|default:"なし" }}</div>
                </div>

                <div style="display: flex; gap: 8px;">
                    <a href="{% url 'respond_invitation' invitation.id 'accept' %}" class="c-btn-primary" style="text-decoration: none; padding: 6px 16px;">
                        参加する
                    </a>
                    <a href="{% url 'respond_invitation' invitation.id 'decline' %}" style="padding: 6px 16px; border: 1px solid #E2E2E2; border-radius: 4px; color: #1D1C1D; font-weight: 700; font-size: 13px; text-decoration: none; background: white;">
                        辞退
                    </a>
                </div>
            </div>
            
            <div style="font-size: 12px; color: #616061;">
                {{ invitation.created_at|date:"m/d H:i" }}
            </div>
        </div>
        {% empty %}
        <div style="text-align: center; padding: 40px; color: #616061;">
            <i class="bi bi-bell-slash" style="font-size: 24px; margin-bottom: 10px; display: block;"></i>
            新しい通知はありません
        </div>
        {% endfor %}

    </div>
</div>
{% endblock %}